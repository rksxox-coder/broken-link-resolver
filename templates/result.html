{% extends "base.html" %}
{% block content %}

<div class="max-w-4xl mx-auto p-8 rounded-2xl bg-gray-900 shadow-xl">

    <h2 class="text-3xl font-bold text-blue-300 text-center mb-6">Result</h2>

    <!-- SINGLE RESULT -->
    {% if result %}
    <div class="p-5 rounded-xl bg-gray-800">

        <p class="mb-2">
            <span class="font-semibold">Input URL:</span> 
            <span class="text-gray-300">{{ result.input }}</span>
        </p>

        <p>
            <span class="font-semibold">Status:</span>

            {% if result.working %}
                <span class="text-green-400 font-bold">Working ✔</span>
            {% else %}
                <span class="text-red-400 font-bold">Broken ✘</span>
            {% endif %}
        </p>

        {% if result.alternative %}
        <p class="mt-2">
            <span class="font-semibold">Suggested Alternative:</span>
            <a href="{{ result.alternative }}" class="text-blue-400 underline">
                {{ result.alternative }}
            </a>
        </p>
        {% endif %}

        <p class="mt-2 text-gray-400 text-sm">
            Error: {{ result.error }}
        </p>

    </div>
    {% endif %}

    <!-- BULK RESULTS -->
    {% if results %}
    <table class="w-full mt-6 border border-gray-700 rounded-lg overflow-hidden">
        <thead class="bg-gray-800">
            <tr>
                <th class="p-3 border-b border-gray-700">Input URL</th>
                <th class="p-3 border-b border-gray-700">Status</th>
                <th class="p-3 border-b border-gray-700">Alternative</th>
            </tr>
        </thead>
        <tbody>
            {% for item in results %}
            <tr class="border-b border-gray-700">
                <td class="p-3">{{ item.input }}</td>
                <td class="p-3">
                    {% if item.working %}
                        <span class="text-green-400 font-bold">Working ✔</span>
                    {% else %}
                        <span class="text-red-400 font-bold">Broken ✘</span>
                    {% endif %}
                </td>
                <td class="p-3">
                    {% if item.alternative %}
                    <a href="{{ item.alternative }}" class="text-blue-400 underline">
                        {{ item.alternative }}
                    </a>
                    {% else %}
                        <span class="text-gray-500">—</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}

    {% if results %}
<form id="downloadForm" method="POST" action="/download">
    <input type="hidden" name="results" id="resultsData">
    <button 
        type="submit"
        class="mt-5 bg-purple-600 hover:bg-purple-700 px-5 py-3 rounded-lg text-white font-semibold"
        onclick="prepareCSV()"
    >
        Download CSV
    </button>
</form>
{% endif %}


    <a href="/" class="mt-6 inline-block text-blue-400 underline">← Go back</a>

</div>

{% endblock %}
